<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Extended pathway analysis • MNet</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extended pathway analysis">
<meta name="description" content="the extended pathway analysis
">
<meta property="og:description" content="the extended pathway analysis
">
<meta property="og:image" content="/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MNet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/MNet.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/01-Pathway_analysis.html">Extended pathway analysis</a></li>
    <li><a class="dropdown-item" href="../articles/02-Subnetwork_analysis.html">Metabolism-related subnetwork analysis</a></li>
    <li><a class="dropdown-item" href="../articles/03-Routine_analysis.html">Rountine analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tuantuangui/MNet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Extended pathway analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tuantuangui/MNet/blob/HEAD/vignettes/01-Pathway_analysis.Rmd" class="external-link"><code>vignettes/01-Pathway_analysis.Rmd</code></a></small>
      <div class="d-none name"><code>01-Pathway_analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="differential-information">
<font size="5">Differential Information</font><a class="anchor" aria-label="anchor" href="#differential-information"></a>
</h2>
<p>The case study by Liao et al. (2022) integrated metabolic and
transcriptional analysis to reveal elevated pyrimidine metabolism and
glutaminolysis in TNBC among 31 breast tumors, and classified them into
two clusters. We utilize MNet to identify a set of features whose
activities significantly differ between these two clusters. This result
will hopefully hint at some specific biological activities that are
pathologically altered in tumoral samples.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tuantuangui/MNet/" class="external-link">MNet</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/contribution-knowledge-mining/" class="external-link">clusterProfiler</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/datapplab/pathview" class="external-link">pathview</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="pathway-enrichment-analysis">
<font size="5">Pathway enrichment analysis</font><a class="anchor" aria-label="anchor" href="#pathway-enrichment-analysis"></a>
</h2>
<p>Pathway enrichment analysis, includes gene pathway enrichment
analysis only focusing on genes, metabolite pathway enrichment analysis
only focusing on metabolites and extended pathway enrichment analysis
focusing on both genes and metabolites, using function “ePEAlyser” in
MNet.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## meta_dat is the metabolic data of the 31 samples</span></span>
<span><span class="co">## gene_dat is the transcriptional data of the 31 samples</span></span>
<span><span class="co">## group is the group information of the 31 samples</span></span>
<span></span>
<span><span class="co">## mlimma is the function of Differential Metabolite analysis by limma</span></span>
<span></span>
<span><span class="va">diff_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mlimma.html">mlimma</a></span><span class="op">(</span><span class="va">meta_dat</span>, <span class="va">group</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">diff_meta</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 8</span></span></span>
<span><span class="co">##   logFC AveExpr     t  P.Value    adj.P.Val     B  logP name  </span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>  2.86    22.6  9.25 1.52<span style="color: #949494;">e</span><span style="color: #BB0000;">-10</span> 0.000<span style="text-decoration: underline;">000</span>033<span style="text-decoration: underline;">2</span> 14.1   7.48 C02045</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>  2.44    26.2  7.80 6.83<span style="color: #949494;">e</span><span style="color: #BB0000;">- 9</span> 0.000<span style="text-decoration: underline;">000</span>748  10.4   6.13 C00267</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">1.82</span>    27.1 -<span style="color: #BB0000;">6.80</span> 1.10<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span> 0.000<span style="text-decoration: underline;">006</span>22    7.64  5.21 C00073</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> -<span style="color: #BB0000;">3.78</span>    20.9 -<span style="color: #BB0000;">6.79</span> 1.14<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span> 0.000<span style="text-decoration: underline;">006</span>22    7.61  5.21 C05674</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> -<span style="color: #BB0000;">2.20</span>    21.4 -<span style="color: #BB0000;">6.58</span> 2.07<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span> 0.000<span style="text-decoration: underline;">009</span>07    7.02  5.04 C00255</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> -<span style="color: #BB0000;">2.37</span>    21.6 -<span style="color: #BB0000;">6.45</span> 2.98<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span> 0.000<span style="text-decoration: underline;">010</span>9     6.66  4.96 C00242</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diff_gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mlimma.html">mlimma</a></span><span class="op">(</span><span class="va">gene_dat</span>, <span class="va">group</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">diff_gene</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 8</span></span></span>
<span><span class="co">##    logFC AveExpr      t  P.Value    adj.P.Val     B  logP name  </span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   6.92   23.1   11.3  1.07<span style="color: #949494;">e</span><span style="color: #BB0000;">-12</span> 0.000<span style="text-decoration: underline;">000</span>019<span style="text-decoration: underline;">0</span>  17.9  7.72 APH1B </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>  21.4    23.4   10.6  5.69<span style="color: #949494;">e</span><span style="color: #BB0000;">-12</span> 0.000<span style="text-decoration: underline;">000</span>050<span style="text-decoration: underline;">6</span>  16.4  7.30 GFRA1 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>  -<span style="color: #BB0000;">5.76</span>   24.4  -<span style="color: #BB0000;">10.2</span>  1.67<span style="color: #949494;">e</span><span style="color: #BB0000;">-11</span> 0.000<span style="text-decoration: underline;">000</span>093<span style="text-decoration: underline;">7</span>  15.5  7.03 RFC4  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>  10.5    14.8   10.1  2.11<span style="color: #949494;">e</span><span style="color: #BB0000;">-11</span> 0.000<span style="text-decoration: underline;">000</span>093<span style="text-decoration: underline;">7</span>  15.3  7.03 FAM47E</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>   4.02    5.65   9.83 3.69<span style="color: #949494;">e</span><span style="color: #BB0000;">-11</span> 0.000<span style="text-decoration: underline;">000</span>120   14.8  6.92 FAM87B</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> -<span style="color: #BB0000;">10.8</span>    20.6   -<span style="color: #BB0000;">9.79</span> 4.07<span style="color: #949494;">e</span><span style="color: #BB0000;">-11</span> 0.000<span style="text-decoration: underline;">000</span>120   14.7  6.92 ORC6</span></span></code></pre>
<div class="section level3">
<h3 id="extended-pathway-enrichment-analysis-epea">
<font size="4">Extended pathway enrichment analysis
(ePEA)</font><a class="anchor" aria-label="anchor" href="#extended-pathway-enrichment-analysis-epea"></a>
</h3>
<p>Function ‘ePEAlyser’ with ‘Extended’ parameter, investigates
metabolic pathway dysregulation considering both metabolites and genes,
which we refer to as ePEA.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## combine the metabolite information and gene information</span></span>
<span></span>
<span><span class="va">all_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">diff_gene</span>, <span class="va">diff_meta</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">all_dat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 8</span></span></span>
<span><span class="co">##    logFC AveExpr      t  P.Value    adj.P.Val     B  logP name  </span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   6.92   23.1   11.3  1.07<span style="color: #949494;">e</span><span style="color: #BB0000;">-12</span> 0.000<span style="text-decoration: underline;">000</span>019<span style="text-decoration: underline;">0</span>  17.9  7.72 APH1B </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>  21.4    23.4   10.6  5.69<span style="color: #949494;">e</span><span style="color: #BB0000;">-12</span> 0.000<span style="text-decoration: underline;">000</span>050<span style="text-decoration: underline;">6</span>  16.4  7.30 GFRA1 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>  -<span style="color: #BB0000;">5.76</span>   24.4  -<span style="color: #BB0000;">10.2</span>  1.67<span style="color: #949494;">e</span><span style="color: #BB0000;">-11</span> 0.000<span style="text-decoration: underline;">000</span>093<span style="text-decoration: underline;">7</span>  15.5  7.03 RFC4  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>  10.5    14.8   10.1  2.11<span style="color: #949494;">e</span><span style="color: #BB0000;">-11</span> 0.000<span style="text-decoration: underline;">000</span>093<span style="text-decoration: underline;">7</span>  15.3  7.03 FAM47E</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>   4.02    5.65   9.83 3.69<span style="color: #949494;">e</span><span style="color: #BB0000;">-11</span> 0.000<span style="text-decoration: underline;">000</span>120   14.8  6.92 FAM87B</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> -<span style="color: #BB0000;">10.8</span>    20.6   -<span style="color: #BB0000;">9.79</span> 4.07<span style="color: #949494;">e</span><span style="color: #BB0000;">-11</span> 0.000<span style="text-decoration: underline;">000</span>120   14.7  6.92 ORC6</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## filter the increase differential genes and metabolites</span></span>
<span><span class="va">all_dat1</span> <span class="op">&lt;-</span> <span class="va">all_dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&gt;</span> <span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## the increase pathway analysis of both genes and metabolites</span></span>
<span><span class="va">result1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ePEAlyser.html">ePEAlyser</a></span><span class="op">(</span><span class="va">all_dat1</span><span class="op">$</span><span class="va">name</span>, out <span class="op">=</span> <span class="st">"Extended"</span>, p_cutoff <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## filter the decrease differential genes and metabolites</span></span>
<span><span class="va">all_dat2</span> <span class="op">&lt;-</span> <span class="va">all_dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ePEAlyser performs pathway enrichment analysis of differential metabolites and differential expression genes, utilizing the Extended as a parameter</span></span>
<span><span class="va">result2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ePEAlyser.html">ePEAlyser</a></span><span class="op">(</span><span class="va">all_dat2</span><span class="op">$</span><span class="va">name</span>, out <span class="op">=</span> <span class="st">"Extended"</span>, p_cutoff <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result1</span><span class="op">$</span><span class="va">p_barplot</span>, <span class="va">result2</span><span class="op">$</span><span class="va">p_barplot</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="01-Pathway_analysis_files/figure-html/ePEA-1.png" width="1728"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result1</span><span class="op">$</span><span class="va">gp</span></span></code></pre></div>
<p><img src="01-Pathway_analysis_files/figure-html/ePEA-2.png" width="1728"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result2</span><span class="op">$</span><span class="va">gp</span></span></code></pre></div>
<p><img src="01-Pathway_analysis_files/figure-html/ePEA-3.png" width="1728"></p>
</div>
<div class="section level3">
<h3 id="metabolite-pathway-enrichment-analysis-mpea">
<font size="4">Metabolite pathway enrichment analysis
(mPEA)</font><a class="anchor" aria-label="anchor" href="#metabolite-pathway-enrichment-analysis-mpea"></a>
</h3>
<p>Function ‘ePEAlyser’ with ‘metabolite’ parameter, investigates
metabolic pathway dysregulation considering only metabolites, which we
refer to as mPEA.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## filter the increase differential metabolites</span></span>
<span><span class="va">diff_meta1</span> <span class="op">&lt;-</span> <span class="va">diff_meta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&gt;</span> <span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ePEAlyser performs pathway enrichment analysis of differential metabolites, utilizing 'metabolite' as a parameter</span></span>
<span><span class="va">result1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ePEAlyser.html">ePEAlyser</a></span><span class="op">(</span><span class="va">diff_meta1</span><span class="op">$</span><span class="va">name</span>, out <span class="op">=</span> <span class="st">"metabolite"</span>, p_cutoff <span class="op">=</span></span>
<span>                             <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## filter the decrease differential metabolites</span></span>
<span><span class="va">diff_meta2</span> <span class="op">&lt;-</span> <span class="va">diff_meta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ePEAlyser performs pathway enrichment analysis of differential metabolites, utilizing 'metabolite' as a parameter</span></span>
<span><span class="va">result2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ePEAlyser.html">ePEAlyser</a></span><span class="op">(</span><span class="va">diff_meta2</span><span class="op">$</span><span class="va">name</span>, out <span class="op">=</span> <span class="st">"metabolite"</span>, p_cutoff <span class="op">=</span></span>
<span>                             <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result1</span><span class="op">$</span><span class="va">p_barplot</span>, <span class="va">result2</span><span class="op">$</span><span class="va">p_barplot</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="01-Pathway_analysis_files/figure-html/mPEA-1.png" width="1728"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result1</span><span class="op">$</span><span class="va">gp</span></span></code></pre></div>
<p><img src="01-Pathway_analysis_files/figure-html/mPEA-2.png" width="1728"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result2</span><span class="op">$</span><span class="va">gp</span></span></code></pre></div>
<p><img src="01-Pathway_analysis_files/figure-html/mPEA-3.png" width="1728"></p>
</div>
<div class="section level3">
<h3 id="gene-pathway-enrichment-analysis-gpea">
<font size="4">Gene pathway enrichment analysis (gPEA)</font><a class="anchor" aria-label="anchor" href="#gene-pathway-enrichment-analysis-gpea"></a>
</h3>
<p>Function ‘ePEAlyser’ with ‘gene’ parameter, investigates metabolic
pathway dysregulation considering only genes, which we refer to as
gPEA.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## filter the increase differential expression genes</span></span>
<span><span class="va">diff_gene1</span> <span class="op">&lt;-</span> <span class="va">diff_gene</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&gt;</span> <span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ePEAlyser performs pathway enrichment analysis of differential genes, utilizing 'gene' as a parameter</span></span>
<span><span class="va">result1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ePEAlyser.html">ePEAlyser</a></span><span class="op">(</span><span class="va">diff_gene1</span><span class="op">$</span><span class="va">name</span>, out <span class="op">=</span> <span class="st">"gene"</span>, p_cutoff <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## filter the decrease differential expression genes</span></span>
<span><span class="va">diff_gene2</span> <span class="op">&lt;-</span> <span class="va">diff_gene</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ePEAlyser performs pathway enrichment analysis of differential genes, utilizing 'gene' as a parameter</span></span>
<span><span class="va">result2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ePEAlyser.html">ePEAlyser</a></span><span class="op">(</span><span class="va">diff_gene2</span><span class="op">$</span><span class="va">name</span>, out <span class="op">=</span> <span class="st">"gene"</span>, p_cutoff <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result1</span><span class="op">$</span><span class="va">p_barplot</span>, <span class="va">result2</span><span class="op">$</span><span class="va">p_barplot</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="01-Pathway_analysis_files/figure-html/gPEA-1.png" width="1728"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result1</span><span class="op">$</span><span class="va">gp</span></span></code></pre></div>
<p><img src="01-Pathway_analysis_files/figure-html/gPEA-2.png" width="1728"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result2</span><span class="op">$</span><span class="va">gp</span></span></code></pre></div>
<p><img src="01-Pathway_analysis_files/figure-html/gPEA-3.png" width="1728"></p>
</div>
</div>
<div class="section level2">
<h2 id="pathway-differential-abundance-analysis">
<font size="5">Pathway differential abundance analysis</font><a class="anchor" aria-label="anchor" href="#pathway-differential-abundance-analysis"></a>
</h2>
<p>Pathway differential abundance analysis, includes gene pathway
differential abundance analysis only focusing on genes, metabolite
pathway differential abundance analysis only focusing on metabolites and
extended pathway differential abundance analysis focusing on both genes
and metabolites, using function “ePDAlyser” in MNet.</p>
<div class="section level3">
<h3 id="extended-pathway-differential-abundance-score-epda">
<font size="4">Extended pathway differential abundance score
(ePDA)</font><a class="anchor" aria-label="anchor" href="#extended-pathway-differential-abundance-score-epda"></a>
</h3>
<p>Function ‘ePDAlyser’ with ‘Extended’ parameter, investigates
metabolic pathway dysregulation considering both metabolites and genes,
which we refer to as ePDA (extended pathway differential abundance).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## filter the differential expression genes</span></span>
<span></span>
<span><span class="va">diff_gene_increase</span> <span class="op">&lt;-</span>  <span class="va">diff_gene</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&gt;</span> <span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">diff_gene_decrease</span> <span class="op">&lt;-</span> <span class="va">diff_gene</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## filter the differential metabolites</span></span>
<span></span>
<span><span class="va">diff_meta_increase</span> <span class="op">&lt;-</span> <span class="va">diff_meta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&gt;</span> <span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="va">diff_meta_decrease</span> <span class="op">&lt;-</span> <span class="va">diff_meta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## the extended pathway differential abundance analysis</span></span>
<span><span class="va">ExtendDAscore_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ePDAlyser.html">ePDAlyser</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">diff_gene_increase</span><span class="op">$</span><span class="va">name</span>, <span class="va">diff_meta_increase</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">diff_gene_decrease</span><span class="op">$</span><span class="va">name</span>, <span class="va">diff_meta_decrease</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">diff_gene</span><span class="op">$</span><span class="va">name</span>, <span class="va">diff_meta</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>,</span>
<span>  sort_plot <span class="op">=</span> <span class="st">"category"</span>,</span>
<span>  min_measured_num <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  out <span class="op">=</span> <span class="st">"Extended"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ExtendDAscore_result</span></span></code></pre></div>
<pre><code><span><span class="co">## $result</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 84 × 10</span></span></span>
<span><span class="co">##    Pathway                    DA_score Increase_members_num Decrease_members_num</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Neomycin, kanamycin and g…   -<span style="color: #BB0000;">0.571</span>                    0                    4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Phenylalanine, tyrosine a…   -<span style="color: #BB0000;">0.4</span>                      0                    4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Biotin metabolism            -<span style="color: #BB0000;">0.4</span>                      1                    3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Oxidative phosphorylation    -<span style="color: #BB0000;">0.392</span>                    6                   53</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> D-Amino acid metabolism      -<span style="color: #BB0000;">0.391</span>                    4                   13</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> Cysteine and methionine m…   -<span style="color: #BB0000;">0.35</span>                     7                   28</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> Phosphonate and phosphina…   -<span style="color: #BB0000;">0.333</span>                    2                    6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> Sulfur metabolism            -<span style="color: #BB0000;">0.286</span>                    1                    5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Steroid biosynthesis         -<span style="color: #BB0000;">0.263</span>                    2                    7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> Caffeine metabolism          -<span style="color: #BB0000;">0.25</span>                     1                    2</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 74 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 6 more variables: Measured_members_num &lt;int&gt;, Increase_member_result &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Decrease_member_result &lt;chr&gt;, Measure_member_result &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   KEGG_pathwayid &lt;chr&gt;, `Pathway Category` &lt;chr&gt;</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $p</span></span></code></pre>
<p><img src="01-Pathway_analysis_files/figure-html/ePDA-1.png" width="960"></p>
</div>
<div class="section level3">
<h3 id="metabolite-pathway-differential-abundance-score-mpda">
<font size="4">Metabolite pathway differential abundance score
(mPDA)</font><a class="anchor" aria-label="anchor" href="#metabolite-pathway-differential-abundance-score-mpda"></a>
</h3>
<p>Function ‘ePDAlyser’ with ‘metabolite’ parameter, investigates
metabolic pathway dysregulation considering only metabolites, which we
refer to as mPDA (metabolite pathway differential abundance).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## filter the differential metabolites</span></span>
<span></span>
<span><span class="va">diff_meta_increase</span> <span class="op">&lt;-</span> <span class="va">diff_meta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&gt;</span> <span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="va">diff_meta_decrease</span> <span class="op">&lt;-</span> <span class="va">diff_meta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## the metabolite pathway differential abundance analysis</span></span>
<span><span class="va">dascore_result_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ePDAlyser.html">ePDAlyser</a></span><span class="op">(</span><span class="va">diff_meta_increase</span><span class="op">$</span><span class="va">name</span>,</span>
<span>                               <span class="va">diff_meta_decrease</span><span class="op">$</span><span class="va">name</span>,</span>
<span>                               <span class="va">diff_meta</span><span class="op">$</span><span class="va">name</span>,</span>
<span>                               sort_plot <span class="op">=</span> <span class="st">"category"</span>,</span>
<span>                               min_measured_num <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                               out <span class="op">=</span> <span class="st">"metabolite"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dascore_result_meta</span></span></code></pre></div>
<pre><code><span><span class="co">## $result</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 59 × 10</span></span></span>
<span><span class="co">##    Pathway                    DA_score Increase_members_num Decrease_members_num</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Starch and sucrose metabo…   -<span style="color: #BB0000;">1</span>                        0                    2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Inositol phosphate metabo…   -<span style="color: #BB0000;">1</span>                        0                    3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Ether lipid metabolism       -<span style="color: #BB0000;">1</span>                        0                    1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Selenocompound metabolism    -<span style="color: #BB0000;">1</span>                        0                    1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> N-Glycan biosynthesis        -<span style="color: #BB0000;">1</span>                        0                    1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> Biotin metabolism            -<span style="color: #BB0000;">1</span>                        0                    2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> Caffeine metabolism          -<span style="color: #BB0000;">1</span>                        0                    2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> Neomycin, kanamycin and g…   -<span style="color: #BB0000;">1</span>                        0                    4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Glycerophospholipid metab…   -<span style="color: #BB0000;">0.909</span>                    0                   10</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> Sulfur metabolism            -<span style="color: #BB0000;">0.8</span>                      0                    4</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 49 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 6 more variables: Measured_members_num &lt;int&gt;, Increase_member_result &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Decrease_member_result &lt;chr&gt;, Measure_member_result &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   KEGG_pathwayid &lt;chr&gt;, `Pathway Category` &lt;chr&gt;</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $p</span></span></code></pre>
<p><img src="01-Pathway_analysis_files/figure-html/mPDA-1.png" width="960"></p>
</div>
<div class="section level3">
<h3 id="gene-pathway-differential-abundance-score-gpda">
<font size="4">Gene pathway differential abundance score
(gPDA)</font><a class="anchor" aria-label="anchor" href="#gene-pathway-differential-abundance-score-gpda"></a>
</h3>
<p>Function ‘ePDAlyser’ with ‘gene’ parameter, investigates metabolic
pathway dysregulation considering only genes, which we refer to as gPDA
(gene pathway differential abundance).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## filter the differential genes</span></span>
<span></span>
<span><span class="va">diff_gene_increase</span> <span class="op">&lt;-</span> <span class="va">diff_gene</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&gt;</span> <span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="va">diff_gene_decrease</span> <span class="op">&lt;-</span> <span class="va">diff_gene</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## the gene pathway differential abundance analysis</span></span>
<span><span class="va">dascore_result_gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ePDAlyser.html">ePDAlyser</a></span><span class="op">(</span><span class="va">diff_gene_increase</span><span class="op">$</span><span class="va">name</span>,</span>
<span>                               <span class="va">diff_gene_decrease</span><span class="op">$</span><span class="va">name</span>,</span>
<span>                               <span class="va">diff_gene</span><span class="op">$</span><span class="va">name</span>,</span>
<span>                               sort_plot <span class="op">=</span> <span class="st">"category"</span>,</span>
<span>                               min_measured_num <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                               out <span class="op">=</span> <span class="st">"gene"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dascore_result_gene</span></span></code></pre></div>
<pre><code><span><span class="co">## $result</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 83 × 10</span></span></span>
<span><span class="co">##    Pathway                    DA_score Increase_members_num Decrease_members_num</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Oxidative phosphorylation    -<span style="color: #BB0000;">0.372</span>                    6                   48</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Phosphonate and phosphina…   -<span style="color: #BB0000;">0.333</span>                    1                    3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Terpenoid backbone biosyn…   -<span style="color: #BB0000;">0.286</span>                    2                    8</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Steroid biosynthesis         -<span style="color: #BB0000;">0.263</span>                    2                    7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> Cysteine and methionine m…   -<span style="color: #BB0000;">0.261</span>                    6                   18</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> Phenylalanine, tyrosine a…   -<span style="color: #BB0000;">0.25</span>                     0                    1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> Glycosphingolipid biosynt…   -<span style="color: #BB0000;">0.24</span>                     2                    8</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> Mannose type O-glycan bio…   -<span style="color: #BB0000;">0.227</span>                    2                    7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Glycosaminoglycan biosynt…   -<span style="color: #BB0000;">0.214</span>                    1                    4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> One carbon pool by folate    -<span style="color: #BB0000;">0.2</span>                      4                    8</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 73 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 6 more variables: Measured_members_num &lt;int&gt;, Increase_member_result &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Decrease_member_result &lt;chr&gt;, Measure_member_result &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   KEGG_pathwayid &lt;chr&gt;, `Pathway Category` &lt;chr&gt;</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $p</span></span></code></pre>
<p><img src="01-Pathway_analysis_files/figure-html/gPDA-1.png" width="960"></p>
</div>
</div>
<div class="section level2">
<h2 id="pathway-set-enrichment-analysis">
<font size="5">Pathway set enrichment analysis</font><a class="anchor" aria-label="anchor" href="#pathway-set-enrichment-analysis"></a>
</h2>
<p>Pathway set enrichment analysis, includes gene set enrichment
analysis only focusing on genes, metabolite set enrichment analysis only
focusing on metabolites and extended pathway set enrichment analysis
focusing on both genes and metabolites, using function “eSEAlyser” in
MNet.</p>
<div class="section level3">
<h3 id="extended-pathway-set-enrichment-analysis-esea">
<font size="4">Extended pathway set enrichment analysis
(eSEA)</font><a class="anchor" aria-label="anchor" href="#extended-pathway-set-enrichment-analysis-esea"></a>
</h3>
<p>Extended pathway set enrichment analysis which includes genes and
metabolites</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tuantuangui/MNet/" class="external-link">MNet</a></span><span class="op">)</span></span>
<span><span class="va">diff_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mlimma.html">mlimma</a></span><span class="op">(</span><span class="va">meta_dat</span>, <span class="va">group</span><span class="op">)</span></span>
<span><span class="va">diff_gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mlimma.html">mlimma</a></span><span class="op">(</span><span class="va">gene_dat</span>, <span class="va">group</span><span class="op">)</span></span>
<span></span>
<span><span class="va">meta.data</span> <span class="op">&lt;-</span> <span class="va">diff_meta</span><span class="op">$</span><span class="va">logFC</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">meta.data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">diff_meta</span><span class="op">$</span><span class="va">name</span></span>
<span></span>
<span><span class="va">gene.data</span> <span class="op">&lt;-</span> <span class="va">diff_gene</span><span class="op">$</span><span class="va">logFC</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">gene.data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">diff_gene</span><span class="op">$</span><span class="va">name</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">meta.data</span>, <span class="va">gene.data</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## the Extended pathway set enrichment analysis</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eSEAlyser.html">eSEAlyser</a></span><span class="op">(</span><span class="va">dat</span>, out <span class="op">=</span> <span class="st">"Extended"</span><span class="op">)</span></span></code></pre></div>
<p>eSEA plot of all the pathway</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_filter</span> <span class="op">&lt;-</span> <span class="va">result</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pval</span> <span class="op">&lt;</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">NES</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pathway<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">pathway</span>,levels<span class="op">=</span><span class="va">pathway</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">result_filter</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">pathway</span>,<span class="va">NES</span>,fill<span class="op">=</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"blue"</span>, high <span class="op">=</span> <span class="st">"red"</span>, na.value <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="01-Pathway_analysis_files/figure-html/p_pSEA_filter-1.png" width="960"></p>
<p>eSEA plot of interested pathway which includes genes and
metabolites</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## The plot of Butanoate metabolism contains genes and metabolites</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pESEA.html">pESEA</a></span><span class="op">(</span><span class="st">"Oxidative phosphorylation"</span>, <span class="va">dat</span>, out <span class="op">=</span> <span class="st">"Extended"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="01-Pathway_analysis_files/figure-html/pESEA-1.png" width="960"></p>
</div>
<div class="section level3">
<h3 id="metabolite-set-enrichment-analysis-msea">
<font size="4">Metabolite set enrichment analysis (mSEA)</font><a class="anchor" aria-label="anchor" href="#metabolite-set-enrichment-analysis-msea"></a>
</h3>
<p>Metabolite set enrichment analysis which only includes
metabolites</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## the metabolite pathway set enrichment analysis</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eSEAlyser.html">eSEAlyser</a></span><span class="op">(</span><span class="va">meta.data</span>, out <span class="op">=</span> <span class="st">"metabolite"</span><span class="op">)</span></span></code></pre></div>
<p>mSEA plot of interested pathway which only includes metabolites</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## The plot of Butanoate metabolism contains metabolites</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pESEA.html">pESEA</a></span><span class="op">(</span><span class="st">"Oxidative phosphorylation"</span>, <span class="va">meta.data</span>, out <span class="op">=</span> <span class="st">"metabolite"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="01-Pathway_analysis_files/figure-html/mSEA-1.png" width="960"></p>
</div>
<div class="section level3">
<h3 id="gene-set-enrichment-analysis-gsea">
<font size="4">Gene set enrichment analysis (gSEA)</font><a class="anchor" aria-label="anchor" href="#gene-set-enrichment-analysis-gsea"></a>
</h3>
<p>Gene set enrichment analysis which only includes genes</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## the gene pathway set enrichment analysis</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eSEAlyser.html">eSEAlyser</a></span><span class="op">(</span><span class="va">gene.data</span>, out <span class="op">=</span> <span class="st">"gene"</span><span class="op">)</span></span></code></pre></div>
<p>gSEA plot of interested pathway which includes genes</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## The plot of Butanoate metabolism contains genes</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pESEA.html">pESEA</a></span><span class="op">(</span><span class="st">"Oxidative phosphorylation"</span>, <span class="va">gene.data</span>, out <span class="op">=</span> <span class="st">"gene"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="01-Pathway_analysis_files/figure-html/gSEA-1.png" width="960"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tuantuan Gui, Benben Miao, Hai Fang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
