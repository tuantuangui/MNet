<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Extended pathway analysis • MNet</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extended pathway analysis">
<meta name="description" content="the extended pathway analysis
">
<meta property="og:description" content="the extended pathway analysis
">
<meta property="og:image" content="/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MNet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/MNet.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/01-Pathway_analysis.html">Extended pathway analysis</a></li>
    <li><a class="dropdown-item" href="../articles/02-Subnetwork_analysis.html">Metabolism-related subnetwork analysis</a></li>
    <li><a class="dropdown-item" href="../articles/03-Routine_analysis.html">Rountine analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Extended pathway analysis</h1>
            
      

      <div class="d-none name"><code>01-Pathway_analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="differential-information">
<font size="5">Differential Information</font><a class="anchor" aria-label="anchor" href="#differential-information"></a>
</h2>
<p>The case study by Liao et al. (2022) integrated metabolic and
transcriptional analysis to reveal elevated pyrimidine metabolism and
glutaminolysis in TNBC among 31 breast tumors, and classified them into
two clusters. We utilize MNet to identify a set of features whose
activities significantly differ between these two clusters. This result
will hopefully hint at some specific biological activities that are
pathologically altered in tumoral samples.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">MNet</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/biomedical-knowledge-mining-book/" class="external-link">clusterProfiler</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/datapplab/pathview" class="external-link">pathview</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## meta_dat is the metabolic data of the 31 samples</span></span>
<span><span class="co">## gene_dat is the transcriptional data of the 31 samples</span></span>
<span><span class="co">## group is the group information of the 31 samples</span></span>
<span></span>
<span><span class="co">## mlimma is the function of Differential Metabolite analysis by limma</span></span>
<span></span>
<span><span class="va">diff_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mlimma.html">mlimma</a></span><span class="op">(</span><span class="va">meta_dat</span>,<span class="va">group</span><span class="op">)</span></span>
<span><span class="va">diff_gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mlimma.html">mlimma</a></span><span class="op">(</span><span class="va">gene_dat</span>,<span class="va">group</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="pathway-enrichment-analysis">
<font size="5">Pathway enrichment analysis</font><a class="anchor" aria-label="anchor" href="#pathway-enrichment-analysis"></a>
</h2>
<p>Pathway enrichment analysis, includes gene pathway enrichment
analysis only focusing on genes, metabolite pathway enrichment analysis
only focusing on metabolites and extended pathway enrichment analysis
focusing on both genes and metabolites, using function “PathwayAnalysis”
in MNet.</p>
<div class="section level3">
<h3 id="extended-pathway-enrichment-analysis-epea">
<font size="4">Extended pathway enrichment analysis
(ePEA)</font><a class="anchor" aria-label="anchor" href="#extended-pathway-enrichment-analysis-epea"></a>
</h3>
<p>Function ‘PathwayAnalysis’ with ‘Extended’ parameter, investigates
metabolic pathway dysregulation considering both metabolites and genes,
which we refer to as ePEA.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## combine the metabolite information and gene information</span></span>
<span></span>
<span><span class="va">all_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">diff_gene</span>,<span class="va">diff_meta</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## filter the increase differential genes and metabolites</span></span>
<span><span class="va">all_dat1</span> <span class="op">&lt;-</span> <span class="va">all_dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span><span class="op">&gt;</span><span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## the increase pathway analysis of both genes and metabolites</span></span>
<span><span class="va">result1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PathwayAnalysis.html">PathwayAnalysis</a></span><span class="op">(</span><span class="va">all_dat1</span><span class="op">$</span><span class="va">name</span>,out<span class="op">=</span><span class="st">"Extended"</span>,p_cutoff<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## filter the decrease differential genes and metabolites</span></span>
<span><span class="va">all_dat2</span> <span class="op">&lt;-</span> <span class="va">all_dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## PathwayAnalysis performs pathway enrichment analysis of differential metabolites and differential expression genes, utilizing the Extended as a parameter</span></span>
<span><span class="va">result2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PathwayAnalysis.html">PathwayAnalysis</a></span><span class="op">(</span><span class="va">all_dat2</span><span class="op">$</span><span class="va">name</span>,out<span class="op">=</span><span class="st">"Extended"</span>,p_cutoff<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result1</span><span class="op">$</span><span class="va">p_barplot</span>,<span class="va">result2</span><span class="op">$</span><span class="va">p_barplot</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">result1</span><span class="op">$</span><span class="va">gp</span></span>
<span><span class="va">result2</span><span class="op">$</span><span class="va">gp</span></span></code></pre></div>
<p><img src="result_v0131%2FEPE_gene_meta.png"><img src="result_v0131%2FEPE1.png"><img src="result_v0131%2FEPE2.png"></p>
</div>
<div class="section level3">
<h3 id="metabolite-pathway-enrichment-analysis-mpea">
<font size="4">Metabolite pathway enrichment analysis
(mPEA)</font><a class="anchor" aria-label="anchor" href="#metabolite-pathway-enrichment-analysis-mpea"></a>
</h3>
<p>Function ‘PathwayAnalysis’ with ‘metabolite’ parameter, investigates
metabolic pathway dysregulation considering only metabolites, which we
refer to as mPEA.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## filter the increase differential metabolites</span></span>
<span><span class="va">diff_meta1</span> <span class="op">&lt;-</span> <span class="va">diff_meta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span><span class="op">&gt;</span><span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## PathwayAnalysis performs pathway enrichment analysis of differential metabolites, utilizing 'metabolite' as a parameter</span></span>
<span><span class="va">result1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PathwayAnalysis.html">PathwayAnalysis</a></span><span class="op">(</span><span class="va">diff_meta1</span><span class="op">$</span><span class="va">name</span>,out<span class="op">=</span><span class="st">"metabolite"</span>,p_cutoff<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## filter the decrease differential metabolites</span></span>
<span><span class="va">diff_meta2</span> <span class="op">&lt;-</span> <span class="va">diff_meta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## PathwayAnalysis performs pathway enrichment analysis of differential metabolites, utilizing 'metabolite' as a parameter</span></span>
<span><span class="va">result2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PathwayAnalysis.html">PathwayAnalysis</a></span><span class="op">(</span><span class="va">diff_meta2</span><span class="op">$</span><span class="va">name</span>,out<span class="op">=</span><span class="st">"metabolite"</span>,p_cutoff<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result1</span><span class="op">$</span><span class="va">p_barplot</span>,<span class="va">result2</span><span class="op">$</span><span class="va">p_barplot</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">result1</span><span class="op">$</span><span class="va">gp</span></span>
<span><span class="va">result2</span><span class="op">$</span><span class="va">gp</span></span></code></pre></div>
<p><img src="result_v0131%2FPE_meta.png"></p>
<pre><code><span><span class="co">## Warning: package 'knitr' was built under R version 4.3.3</span></span></code></pre>
<p><img src="result_v0131%2FPE_meta1.png" width="30%" style="display: block; margin: auto;"></p>
<p><img src="result_v0131%2FPE_meta2.png"></p>
</div>
<div class="section level3">
<h3 id="gene-pathway-enrichment-analysis-gpea">
<font size="4">Gene pathway enrichment analysis (gPEA)</font><a class="anchor" aria-label="anchor" href="#gene-pathway-enrichment-analysis-gpea"></a>
</h3>
<p>Function ‘PathwayAnalysis’ with ‘gene’ parameter, investigates
metabolic pathway dysregulation considering only genes, which we refer
to as gPEA.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## filter the increase differential expression genes</span></span>
<span><span class="va">diff_gene1</span> <span class="op">&lt;-</span> <span class="va">diff_gene</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span><span class="op">&gt;</span><span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## PathwayAnalysis performs pathway enrichment analysis of differential genes, utilizing 'gene' as a parameter</span></span>
<span><span class="va">result1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PathwayAnalysis.html">PathwayAnalysis</a></span><span class="op">(</span><span class="va">diff_gene1</span><span class="op">$</span><span class="va">name</span>,out<span class="op">=</span><span class="st">"gene"</span>,p_cutoff<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## filter the decrease differential expression genes</span></span>
<span><span class="va">diff_gene2</span> <span class="op">&lt;-</span> <span class="va">diff_gene</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## PathwayAnalysis performs pathway enrichment analysis of differential genes, utilizing 'gene' as a parameter</span></span>
<span><span class="va">result2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PathwayAnalysis.html">PathwayAnalysis</a></span><span class="op">(</span><span class="va">diff_gene2</span><span class="op">$</span><span class="va">name</span>,out<span class="op">=</span><span class="st">"gene"</span>,p_cutoff<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result1</span><span class="op">$</span><span class="va">p_barplot</span>,<span class="va">result2</span><span class="op">$</span><span class="va">p_barplot</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">result1</span><span class="op">$</span><span class="va">gp</span></span>
<span><span class="va">result2</span><span class="op">$</span><span class="va">gp</span></span></code></pre></div>
<p><img src="result_v0131%2FPE_gene.png"><img src="result_v0131%2FPE_gene1.png"><img src="result_v0131%2FPE_gene2.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="pathway-differential-abundance-analysis">
<font size="5">Pathway differential abundance analysis</font><a class="anchor" aria-label="anchor" href="#pathway-differential-abundance-analysis"></a>
</h2>
<p>Pathway differential abundance analysis, includes gene pathway
differential abundance analysis only focusing on genes, metabolite
pathway differential abundance analysis only focusing on metabolites and
extended pathway differential abundance analysis focusing on both genes
and metabolites, using function “DAscore” in MNet.</p>
<div class="section level3">
<h3 id="extended-pathway-differential-abundance-score-epda">
<font size="4">Extended pathway differential abundance score
(ePDA)</font><a class="anchor" aria-label="anchor" href="#extended-pathway-differential-abundance-score-epda"></a>
</h3>
<p>Function ‘DAscore’ with ‘Extended’ parameter, investigates metabolic
pathway dysregulation considering both metabolites and genes, which we
refer to as ePDA (extended pathway differential abundance).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## filter the differential expression genes</span></span>
<span></span>
<span><span class="va">diff_gene_increase</span> <span class="op">&lt;-</span>  <span class="va">diff_gene</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span><span class="op">&gt;</span><span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">diff_gene_decrease</span> <span class="op">&lt;-</span> <span class="va">diff_gene</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## filter the differential metabolites</span></span>
<span></span>
<span><span class="va">diff_meta_increase</span> <span class="op">&lt;-</span> <span class="va">diff_meta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span><span class="op">&gt;</span><span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="va">diff_meta_decrease</span> <span class="op">&lt;-</span> <span class="va">diff_meta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## the extended pathway differential abundance analysis</span></span>
<span> <span class="va">ExtendDAscore_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DAscore.html">DAscore</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">diff_gene_increase</span><span class="op">$</span><span class="va">name</span>,<span class="va">diff_meta_increase</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">diff_gene_decrease</span><span class="op">$</span><span class="va">name</span>,<span class="va">diff_meta_decrease</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">diff_gene</span><span class="op">$</span><span class="va">name</span>,<span class="va">diff_meta</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>,min_measured_num <span class="op">=</span> <span class="fl">2</span>,out<span class="op">=</span><span class="st">"Extended"</span><span class="op">)</span></span></code></pre></div>
<p><img src="result_v0131%2FEDA.png" style="width:50.0%"></p>
</div>
<div class="section level3">
<h3 id="metabolite-pathway-differential-abundance-score-mpda">
<font size="4">Metabolite pathway differential abundance score
(mPDA)</font><a class="anchor" aria-label="anchor" href="#metabolite-pathway-differential-abundance-score-mpda"></a>
</h3>
<p>Function ‘DAscore’ with ‘metabolite’ parameter, investigates
metabolic pathway dysregulation considering only metabolites, which we
refer to as mPDA (metabolite pathway differential abundance).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## filter the differential metabolites</span></span>
<span></span>
<span><span class="va">diff_meta_increase</span> <span class="op">&lt;-</span> <span class="va">diff_meta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&gt;</span> <span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="va">diff_meta_decrease</span> <span class="op">&lt;-</span> <span class="va">diff_meta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## the metabolite pathway differential abundance analysis</span></span>
<span><span class="va">dascore_result_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DAscore.html">DAscore</a></span><span class="op">(</span><span class="va">diff_meta_increase</span><span class="op">$</span><span class="va">name</span>,<span class="va">diff_meta_decrease</span><span class="op">$</span><span class="va">name</span>,<span class="va">diff_meta</span><span class="op">$</span><span class="va">name</span>,out<span class="op">=</span><span class="st">"metabolite"</span><span class="op">)</span></span></code></pre></div>
<p><img src="result_v0131%2FDAscore_metabolite.png" style="width:50.0%"></p>
</div>
<div class="section level3">
<h3 id="gene-pathway-differential-abundance-score-gpda">
<font size="4">Gene pathway differential abundance score
(gPDA)</font><a class="anchor" aria-label="anchor" href="#gene-pathway-differential-abundance-score-gpda"></a>
</h3>
<p>Function ‘DAscore’ with ‘gene’ parameter, investigates metabolic
pathway dysregulation considering only genes, which we refer to as gPDA
(gene pathway differential abundance).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## filter the differential genes</span></span>
<span></span>
<span><span class="va">diff_gene_increase</span> <span class="op">&lt;-</span> <span class="va">diff_gene</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&gt;</span> <span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="va">diff_gene_decrease</span> <span class="op">&lt;-</span> <span class="va">diff_gene</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.58</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## the gene pathway differential abundance analysis</span></span>
<span><span class="va">dascore_result_gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DAscore.html">DAscore</a></span><span class="op">(</span><span class="va">diff_gene_increase</span><span class="op">$</span><span class="va">name</span>,<span class="va">diff_gene_decrease</span><span class="op">$</span><span class="va">name</span>,<span class="va">diff_gene</span><span class="op">$</span><span class="va">name</span>,out<span class="op">=</span><span class="st">"gene"</span><span class="op">)</span></span></code></pre></div>
<p><img src="result_v0131%2FDAscore_gene.png" style="width:50.0%"></p>
</div>
</div>
<div class="section level2">
<h2 id="pathway-set-enrichment-analysis">
<font size="5">Pathway set enrichment analysis</font><a class="anchor" aria-label="anchor" href="#pathway-set-enrichment-analysis"></a>
</h2>
<p>Pathway set enrichment analysis, includes gene set enrichment
analysis only focusing on genes, metabolite set enrichment analysis only
focusing on metabolites and extended pathway set enrichment analysis
focusing on both genes and metabolites, using function “ESEA” in
MNet.</p>
<div class="section level3">
<h3 id="extended-pathway-set-enrichment-analysis-esea">
<font size="4">Extended pathway set enrichment analysis
(eSEA)</font><a class="anchor" aria-label="anchor" href="#extended-pathway-set-enrichment-analysis-esea"></a>
</h3>
<p>Extended pathway set enrichment analysis which includes genes and
metabolites</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## the data is from R package 'clusterProfiler'</span></span>
<span><span class="co">## transform the gene's entrezid to symbol</span></span>
<span><span class="va">gene_symbol</span> <span class="op">&lt;-</span> <span class="fu">clusterProfiler</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/bitr.html" class="external-link">bitr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">gse16873.d</span><span class="op">)</span>,fromType <span class="op">=</span><span class="st">"ENTREZID"</span>,toType<span class="op">=</span><span class="st">"SYMBOL"</span>,OrgDb <span class="op">=</span> <span class="va">org.Hs.eg.db</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">gse16873.d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span>var<span class="op">=</span><span class="st">"ENTREZID"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">gene_symbol</span>,by<span class="op">=</span><span class="st">"ENTREZID"</span><span class="op">)</span></span>
<span><span class="va">gene.data</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">$</span><span class="va">DCIS_1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">gene.data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">$</span><span class="va">SYMBOL</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sim.cpd.data</span>,<span class="va">gene.data</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## the Extended pathway set enrichment analysis</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ESEA.html">ESEA</a></span><span class="op">(</span><span class="va">dat</span>,out<span class="op">=</span><span class="st">"Extended"</span><span class="op">)</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">leadingEdge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">leadingEdge</span><span class="op">)</span></span></code></pre></div>
<p>eSEA plot of interested pathway which includes genes and
metabolites</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## The plot of Butanoate metabolism contains genes and metabolites</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pESEA.html">pESEA</a></span><span class="op">(</span><span class="st">"Butanoate metabolism"</span>,<span class="va">dat</span>,out<span class="op">=</span><span class="st">"Extended"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="result_v0131%2FESEA_Butanoate_extended.png" alt="The eSEA plot of Butanoate metabolism" width="60%"><p class="caption">
The eSEA plot of Butanoate metabolism
</p>
</div>
</div>
<div class="section level3">
<h3 id="metabolite-set-enrichment-analysis-msea">
<font size="4">Metabolite set enrichment analysis (mSEA)</font><a class="anchor" aria-label="anchor" href="#metabolite-set-enrichment-analysis-msea"></a>
</h3>
<p>Metabolite set enrichment analysis which only includes
metabolites</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## the metabolite pathway set enrichment analysis</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ESEA.html">ESEA</a></span><span class="op">(</span><span class="va">sim.cpd.data</span>,out<span class="op">=</span><span class="st">"metabolite"</span><span class="op">)</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">leadingEdge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">leadingEdge</span><span class="op">)</span></span></code></pre></div>
<p>mSEA plot of interested pathway which only includes metabolites</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## The plot of Butanoate metabolism contains metabolites</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pESEA.html">pESEA</a></span><span class="op">(</span><span class="st">"Butanoate metabolism"</span>,<span class="va">sim.cpd.data</span>,out<span class="op">=</span><span class="st">"metabolite"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="result_v0131%2FESEA_Butanoate_metabolite.png" alt="The mSEA plot of Butanoate metabolism" width="60%"><p class="caption">
The mSEA plot of Butanoate metabolism
</p>
</div>
</div>
<div class="section level3">
<h3 id="gene-set-enrichment-analysis-gsea">
<font size="4">Gene set enrichment analysis (gSEA)</font><a class="anchor" aria-label="anchor" href="#gene-set-enrichment-analysis-gsea"></a>
</h3>
<p>Gene set enrichment analysis which only includes genes</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## the gene pathway set enrichment analysis</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ESEA.html">ESEA</a></span><span class="op">(</span><span class="va">gene.data</span>,out<span class="op">=</span><span class="st">"gene"</span><span class="op">)</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">leadingEdge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">leadingEdge</span><span class="op">)</span></span></code></pre></div>
<p>gSEA plot of interested pathway which includes genes</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## The plot of Butanoate metabolism contains genes</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pESEA.html">pESEA</a></span><span class="op">(</span><span class="st">"Butanoate metabolism"</span>,<span class="va">gene.data</span>,out<span class="op">=</span><span class="st">"gene"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="result_v0131%2FESEA_Butanoate_gene.png" alt="The gSEA plot of Butanoate metabolism" width="60%"><p class="caption">
The gSEA plot of Butanoate metabolism
</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tuantuan Gui, Hai Fang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
