<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="xEnricherYours is supposed to conduct enrichment analysis given the input data and the ontology in query. It returns an object of class &quot;eTerm&quot;. Enrichment analysis is based on either Fisher's exact test or Hypergeometric test."><title>Function to conduct enrichment analysis given YOUR own input data — xEnricherYours • MNet</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Function to conduct enrichment analysis given YOUR own input data — xEnricherYours"><meta property="og:description" content="xEnricherYours is supposed to conduct enrichment analysis given the input data and the ontology in query. It returns an object of class &quot;eTerm&quot;. Enrichment analysis is based on either Fisher's exact test or Hypergeometric test."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MNet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/MNet.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01-example_unique.html">Example-unique analyses</a>
    <a class="dropdown-item" href="../articles/02-example_routine.html">Example-rountine analyses</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Function to conduct enrichment analysis given YOUR own input data</h1>
      
      <div class="d-none name"><code>xEnricherYours.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>xEnricherYours</code> is supposed to conduct enrichment analysis given the input data and the ontology in query. It returns an object of class "eTerm". Enrichment analysis is based on either Fisher's exact test or Hypergeometric test.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">xEnricherYours</span><span class="op">(</span></span>
<span>  <span class="va">data.file</span>,</span>
<span>  <span class="va">annotation.file</span>,</span>
<span>  background.file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  size.range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">2000</span><span class="op">)</span>,</span>
<span>  min.overlap <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fisher"</span>, <span class="st">"hypergeo"</span>, <span class="st">"binomial"</span><span class="op">)</span>,</span>
<span>  background.annotatable.only <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p.tail <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"one-tail"</span>, <span class="st">"two-tails"</span><span class="op">)</span>,</span>
<span>  p.adjust.method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BH"</span>, <span class="st">"BY"</span>, <span class="st">"bonferroni"</span>, <span class="st">"holm"</span>, <span class="st">"hochberg"</span>, <span class="st">"hommel"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data.file</dt>
<dd><p>an input data file, containing a list of entities (e.g. genes or SNPs) to test. The entities can be anything, for example, in this file <a href="http://dcgor.r-forge.r-project.org/data/InterPro/InterPro.txt" class="external-link">http://dcgor.r-forge.r-project.org/data/InterPro/InterPro.txt</a>, the entities are InterPro domains (InterPro). As seen in this example, entries in the first column must be domains. If the file also contains other columns, these additional columns will be ignored. Alternatively, the data.file can be a matrix or data frame, assuming that input file has been read. Note: the file should use the tab delimiter as the field separator between columns</p></dd>


<dt>annotation.file</dt>
<dd><p>an input annotation file containing annotations between entities and ontology terms. For example, a file containing annotations between InterPro domains and GO Molecular Function (GOMF) terms can be found in <a href="http://dcgor.r-forge.r-project.org/data/InterPro/Domain2GOMF.txt" class="external-link">http://dcgor.r-forge.r-project.org/data/InterPro/Domain2GOMF.txt</a>. As seen in this example, the input file must contain two columns: 1st column for domains, 2nd column for ontology terms. If there are additional columns, these columns will be ignored. Alternatively, the annotation.file can be a matrix or data frame, assuming that input file has been read. Note: the file should use the tab delimiter as the field separator between columns</p></dd>


<dt>background.file</dt>
<dd><p>an input background file containing a list of entities as the test background. The file format is the same as 'data.file'. By default, it is NULL meaning all annotatable entities (i.g. those entities in 'annotation.file') are used as background</p></dd>


<dt>size.range</dt>
<dd><p>the minimum and maximum size of members of each term in consideration. By default, it sets to a minimum of 10 but no more than 2000</p></dd>


<dt>min.overlap</dt>
<dd><p>the minimum number of overlaps. Only those terms with members that overlap with input data at least min.overlap (3 by default) will be processed</p></dd>


<dt>test</dt>
<dd><p>the test statistic used. It can be "fisher" for using fisher's exact test, "hypergeo" for using hypergeometric test, or "binomial" for using binomial test. Fisher's exact test is to test the independence between gene group (genes belonging to a group or not) and gene annotation (genes annotated by a term or not), and thus compare sampling to the left part of background (after sampling without replacement). Hypergeometric test is to sample at random (without replacement) from the background containing annotated and non-annotated genes, and thus compare sampling to background. Unlike hypergeometric test, binomial test is to sample at random (with replacement) from the background with the constant probability. In terms of the ease of finding the significance, they are in order: hypergeometric test &gt; fisher's exact test &gt; binomial test. In other words, in terms of the calculated p-value, hypergeometric test &lt; fisher's exact test &lt; binomial test</p></dd>


<dt>background.annotatable.only</dt>
<dd><p>logical to indicate whether the background is further restricted to the annotatable (covered by 'annotation.file'). By default, it is NULL: if the background not provided, it will be TRUE; otherwise FALSE. Surely, it can be explicitly stated. Notably, if only one annotation is provided in 'annotation.file', it should be false (also the background.file should be provided)</p></dd>


<dt>p.tail</dt>
<dd><p>the tail used to calculate p-values. It can be either "two-tails" for the significance based on two-tails (ie both over- and under-overrepresentation)  or "one-tail" (by default) for the significance based on one tail (ie only over-representation)</p></dd>


<dt>p.adjust.method</dt>
<dd><p>the method used to adjust p-values. It can be one of "BH", "BY", "bonferroni", "holm", "hochberg" and "hommel". The first two methods "BH" (widely used) and "BY" control the false discovery rate (FDR: the expected proportion of false discoveries amongst the rejected hypotheses); the last four methods "bonferroni", "holm", "hochberg" and "hommel" are designed to give strong control of the family-wise error rate (FWER). Notes: FDR is a less stringent condition than FWER</p></dd>


<dt>verbose</dt>
<dd><p>logical to indicate whether the messages will be displayed in the screen. By default, it sets to false for no display</p></dd>


<dt>silent</dt>
<dd><p>logical to indicate whether the messages will be silent completely. By default, it sets to false. If true, verbose will be forced to be false</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>an object of class "eTerm", a list with following components:</p><ul><li><p><code>term_info</code>: a matrix of nTerm X 4 containing snp/gene set information, where nTerm is the number of terms, and the 4 columns are "id" (i.e. "Term ID"), "name" (i.e. "Term Name"), "namespace" and "distance"</p></li>
<li><p><code>annotation</code>: a list of terms containing annotations, each term storing its annotations. Always, terms are identified by "id"</p></li>
<li><p><code>g</code>: an igraph object to represent DAG</p></li>
<li><p><code>data</code>: a vector containing input data in consideration. It is not always the same as the input data as only those mappable are retained</p></li>
<li><p><code>background</code>: a vector containing the background data. It is not always the same as the input data as only those mappable are retained</p></li>
<li><p><code>overlap</code>: a list of overlapped snp/gene sets, each storing snps overlapped between a snp/gene set and the given input data (i.e. the snps of interest). Always, gene sets are identified by "id"</p></li>
<li><p><code>fc</code>: a vector containing fold changes</p></li>
<li><p><code>zscore</code>: a vector containing z-scores</p></li>
<li><p><code>pvalue</code>: a vector containing p-values</p></li>
<li><p><code>adjp</code>: a vector containing adjusted p-values. It is the p value but after being adjusted for multiple comparisons</p></li>
<li><p><code>or</code>: a vector containing odds ratio</p></li>
<li><p><code>CIl</code>: a vector containing lower bound confidence interval for the odds ratio</p></li>
<li><p><code>CIu</code>: a vector containing upper bound confidence interval for the odds ratio</p></li>
<li><p><code>cross</code>: a matrix of nTerm X nTerm, with an on-diagnal cell for the overlapped-members observed in an individaul term, and off-diagnal cell for the overlapped-members shared betwene two terms</p></li>
<li><p><code>call</code>: the call that produced this result</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>None</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="xEnricher.html">xEnricher</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Load the library</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://XGR.r-forge.r-project.org" class="external-link">XGR</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Enrichment analysis using your own data</span></span></span>
<span class="r-in"><span><span class="co"># a) provide your own data (eg InterPro domains and their annotations by GO terms)</span></span></span>
<span class="r-in"><span><span class="co">## All InterPro domains</span></span></span>
<span class="r-in"><span><span class="va">input.file</span> <span class="op">&lt;-</span> <span class="st">"http://dcgor.r-forge.r-project.org/data/InterPro/InterPro.txt"</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="va">input.file</span>, header<span class="op">=</span><span class="cn">F</span>, row.names<span class="op">=</span><span class="cn">NULL</span>, stringsAsFactors<span class="op">=</span><span class="cn">F</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co">## provide the input domains of interest (eg 100 randomly chosen domains)</span></span></span>
<span class="r-in"><span><span class="va">data.file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">data</span>, <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## InterPro domains annotated by GO Molecular Function (GOMF) terms</span></span></span>
<span class="r-in"><span><span class="va">annotation.file</span> <span class="op">&lt;-</span> <span class="st">"http://dcgor.r-forge.r-project.org/data/InterPro/Domain2GOMF.txt"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># b) perform enrichment analysis</span></span></span>
<span class="r-in"><span><span class="va">eTerm</span> <span class="op">&lt;-</span> <span class="fu">xEnricherYours</span><span class="op">(</span>data.file<span class="op">=</span><span class="va">data.file</span>, annotation.file<span class="op">=</span><span class="va">annotation.file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># c) view enrichment results for the top significant terms</span></span></span>
<span class="r-in"><span><span class="fu"><a href="xEnrichViewer.html">xEnrichViewer</a></span><span class="op">(</span><span class="va">eTerm</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># d) save enrichment results to the file called 'Yours_enrichments.txt'</span></span></span>
<span class="r-in"><span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="xEnrichViewer.html">xEnrichViewer</a></span><span class="op">(</span><span class="va">eTerm</span>, top_num<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">eTerm</span><span class="op">$</span><span class="va">adjp</span><span class="op">)</span>, sortBy<span class="op">=</span><span class="st">"adjp"</span>, details<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.table</a></span><span class="op">(</span><span class="va">output</span>, file<span class="op">=</span><span class="st">"Yours_enrichments.txt"</span>, sep<span class="op">=</span><span class="st">"\t"</span>, row.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># e) barplot of significant enrichment results</span></span></span>
<span class="r-in"><span><span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/XGR/man/xEnrichBarplot.html" class="external-link">xEnrichBarplot</a></span><span class="op">(</span><span class="va">eTerm</span>, top_num<span class="op">=</span><span class="st">"auto"</span>, displayBy<span class="op">=</span><span class="st">"adjp"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using ImmunoBase SNPs and associations/annotations with disease traits</span></span></span>
<span class="r-in"><span><span class="co">## get ImmunoBase</span></span></span>
<span class="r-in"><span><span class="va">RData.location</span> <span class="op">&lt;-</span> <span class="st">"http://galahad.well.ox.ac.uk/bigdata/"</span></span></span>
<span class="r-in"><span><span class="va">ImmunoBase</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/XGR/man/xRDataLoader.html" class="external-link">xRDataLoader</a></span><span class="op">(</span>RData.customised<span class="op">=</span><span class="st">'ImmunoBase'</span>, RData.location<span class="op">=</span><span class="va">RData.location</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## get disease associated variants/SNPs</span></span></span>
<span class="r-in"><span><span class="va">variants_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">ImmunoBase</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>SNP<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">variants</span><span class="op">)</span>, Disease<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">disease</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">variants</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## extract annotations as a data frame: Variant Disease_Name </span></span></span>
<span class="r-in"><span><span class="va">annotation.file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">variants_list</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">annotation.file</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## provide the input SNPs of interest</span></span></span>
<span class="r-in"><span><span class="co">## for example, cis-eQTLs induced by interferon gamma</span></span></span>
<span class="r-in"><span><span class="va">cis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/XGR/man/xRDataLoader.html" class="external-link">xRDataLoader</a></span><span class="op">(</span>RData.customised<span class="op">=</span><span class="st">'JKscience_TS2A'</span>, RData.location<span class="op">=</span><span class="va">RData.location</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data.file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">cis</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">cis</span><span class="op">$</span><span class="va">IFN_t</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'variant'</span><span class="op">)</span><span class="op">]</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># perform enrichment analysis</span></span></span>
<span class="r-in"><span><span class="va">eTerm</span> <span class="op">&lt;-</span> <span class="fu">xEnricherYours</span><span class="op">(</span>data.file<span class="op">=</span><span class="va">data.file</span>, annotation.file<span class="op">=</span><span class="va">annotation.file</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># view enrichment results for the top significant terms</span></span></span>
<span class="r-in"><span><span class="fu"><a href="xEnrichViewer.html">xEnrichViewer</a></span><span class="op">(</span><span class="va">eTerm</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># barplot of significant enrichment results</span></span></span>
<span class="r-in"><span><span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/XGR/man/xEnrichBarplot.html" class="external-link">xEnrichBarplot</a></span><span class="op">(</span><span class="va">eTerm</span>, top_num<span class="op">=</span><span class="st">"auto"</span>, displayBy<span class="op">=</span><span class="st">"adjp"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Tuantuan Gui, Hai Fang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

